# 在线考试系统 - 宝塔面板部署说明

## 1. 打包项目

在本地执行以下命令生成jar包：

```bash
mvn clean package -DskipTests
```

生成的jar包位置：`target/exam-0.0.1-SNAPSHOT.jar`

## 2. 宝塔面板部署步骤

### 2.1 上传文件
1. 将生成的jar包上传到服务器
2. 将 `start.sh`、`stop.sh`、`restart.sh` 脚本上传到服务器
3. 将 `application-prod.properties` 配置文件上传到服务器

### 2.2 配置数据库
1. 在宝塔面板中安装MySQL
2. 创建数据库 `exam`
3. 导入数据库结构和数据
4. 修改 `application-prod.properties` 中的数据库连接信息

### 2.3 修改配置文件
编辑 `application-prod.properties`，修改以下配置：

```properties
# 数据库配置
spring.datasource.username=你的数据库用户名
spring.datasource.password=你的数据库密码
spring.datasource.url=jdbc:mysql://你的数据库地址:3306/exam?useUnicode=true&characterEncoding=UTF-8&useSSL=false&serverTimezone=UTC

# 文件上传路径（根据你的实际路径修改）
material.upload.path=/www/wwwroot/你的项目目录/material
```

### 2.4 修改启动脚本
编辑 `start.sh`、`stop.sh`、`restart.sh`，将路径修改为你的实际项目路径：

```bash
APP_PATH="/www/wwwroot/你的项目目录"
```

### 2.5 设置权限
```bash
chmod +x start.sh stop.sh restart.sh
```

### 2.6 创建必要目录
```bash
mkdir -p /www/wwwroot/你的项目目录/logs
mkdir -p /www/wwwroot/你的项目目录/material
```

## 3. 启动应用

### 3.1 使用脚本启动
```bash
./start.sh
```

### 3.2 查看日志
```bash
tail -f logs/startup.log
```

### 3.3 检查应用状态
```bash
ps -ef | grep exam
```

## 4. 常用命令

- 启动应用：`./start.sh`
- 停止应用：`./stop.sh`
- 重启应用：`./restart.sh`
- 查看日志：`tail -f logs/startup.log`

## 5. 注意事项

1. 确保服务器已安装Java 8或以上版本
2. 确保数据库连接正常
3. 确保文件上传目录有写入权限
4. 建议配置防火墙，只开放必要端口
5. 定期备份数据库和上传的文件

## 6. 故障排查

### 6.1 应用无法启动
- 检查Java版本：`java -version`
- 检查jar包是否完整
- 查看启动日志：`tail -f logs/startup.log`

### 6.2 数据库连接失败
- 检查数据库服务是否启动
- 检查数据库连接信息是否正确
- 检查防火墙设置

### 6.3 文件上传失败
- 检查文件上传目录权限
- 检查磁盘空间是否充足
- 检查文件大小是否超过限制 